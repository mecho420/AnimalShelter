@page "{id:int}"
@model AnimalShelter.Pages.Animals.DetailsModel
@using AnimalShelter.Helpers


@{
    ViewData["Title"] = "Детайли за животно";
    var a = Model.Animal;
    var img = string.IsNullOrWhiteSpace(a.ImagePath) ? "/images/animals/default-dog.jpg" : a.ImagePath;

    // badge клас за статус
    var statusBadge = a.Status.ToString() switch
    {
        "ForAdoption" => "bg-success", 
        "Adopted" => "bg-secondary",
        _ => "bg-secondary"
    };

    // badge клас за пол
    var genderBadge = a.Gender.ToString() switch
    {
        "Male" => "bg-primary",
        "Female" => "bg-danger",
        _ => "bg-secondary"
    };
}

<h1 class="mb-4">Детайли за животно</h1>

<div class="card shadow-sm">
    <div class="card-body">
        <div class="row g-4 align-items-start">

            <div class="col-12 col-lg-5">
                <img src="@img" class="rounded details-img" alt="Снимка на @a.Name" />
            </div>

            <div class="col-12 col-lg-7">
                <div class="d-flex align-items-start justify-content-between">
                    <div>
                        <h2 class="mb-2">@a.Name</h2>

                        <div class="d-flex flex-wrap gap-2 mb-3">
                            <span class="badge @statusBadge">
                                Статус: @a.Status.GetDisplayName()
                            </span>

                            <span class="badge @genderBadge">
                                Пол: @a.Gender.GetDisplayName()
                            </span>
                        </div>
                    </div>
                </div>

                <div class="row g-3 mb-3">
                    <div class="col-12 col-md-6">
                        <div class="border rounded p-3">
                            <div class="text-muted small">Вид</div>
                            <div class="fw-semibold">@a.Species</div>
                        </div>
                    </div>

                    <div class="col-12 col-md-6">
                        <div class="border rounded p-3">
                            <div class="text-muted small">Възраст</div>
                            <div class="fw-semibold">@a.Age години</div>
                        </div>
                    </div>
                </div>

                <hr />

                <h5 class="mt-3">Описание</h5>
                <p class="mb-3">@a.Description</p>

                <h5>Здравна информация</h5>
                <p class="mb-4">@(!string.IsNullOrWhiteSpace(a.HealthInfo) ? a.HealthInfo : "Няма добавена информация.")</p>

                <div class="d-flex flex-wrap gap-2">
                    <a class="btn btn-outline-secondary" asp-page="/Animals/Index">Назад</a>

                    @* Показваме бутона за заявка само ако животното е за осиновяване *@
                    @if (a.Status.ToString() == "ForAdoption")
                    {
                        <a class="btn btn-success"
                           asp-page="/Adoptions/Create"
                           asp-route-animalId="@a.Id">
                            Подай заявка за осиновяване
                        </a>
                    }
                    else
                    {
                        <button class="btn btn-secondary" disabled>Вече е осиновено</button>
                    }
                </div>
            </div>

        </div>
    </div>
</div>
